
<div class="max-w-xl mx-auto p-6 bg-white dark:bg-gray-800 rounded shadow">
  <h2 class="text-2xl font-bold mb-4">Create New Exam</h2>
  <form (ngSubmit)="createExam()" #examForm="ngForm">
    <div class="mb-4">
      <label class="block mb-1 font-medium">Title</label>
      <input type="text" [(ngModel)]="title" name="title" required class="w-full px-3 py-2 border rounded" />
    </div>
    <div class="mb-4">
      <label class="block mb-1 font-medium">Description</label>
      <textarea [(ngModel)]="description" name="description" class="w-full px-3 py-2 border rounded"></textarea>
    </div>
    <div class="mb-4">
      <label class="block mb-1 font-medium">Duration (minutes)</label>
      <input type="number" [(ngModel)]="duration_minutes" name="duration_minutes" min="1" required class="w-full px-3 py-2 border rounded" />
    </div>
    <div class="mb-6">
      <label class="block mb-1 font-medium">Questions</label>
      <div *ngFor="let q of questions; let i = index" class="mb-4 border p-3 rounded bg-gray-50">
        <div class="flex justify-between items-center mb-2">
          <span class="font-semibold">Question {{ i + 1 }}</span>
          <button type="button" (click)="removeQuestion(i)" class="text-red-600 hover:underline">Remove</button>
        </div>
        <input type="text" [(ngModel)]="q.question_text" name="question_text_{{i}}" placeholder="Question text" required class="w-full mb-2 px-2 py-1 border rounded" />
        <select [(ngModel)]="q.question_type" name="question_type_{{i}}" class="mb-2 px-2 py-1 border rounded">
          <option value="multiple_choice">Multiple Choice</option>
          <option value="text">Text</option>
        </select>
        <input type="number" [(ngModel)]="q.points" name="points_{{i}}" min="1" placeholder="Points" class="mb-2 px-2 py-1 border rounded w-24" />
        <div *ngIf="q.question_type === 'multiple_choice'">
          <div *ngFor="let opt of q.options; let j = index" class="flex items-center mb-1">
            <input type="text" [(ngModel)]="opt.option_text" name="option_text_{{i}}_{{j}}" placeholder="Option text" class="px-2 py-1 border rounded mr-2" />
            <label class="flex items-center text-sm">
              <input type="checkbox" [(ngModel)]="opt.is_correct" name="is_correct_{{i}}_{{j}}" class="mr-1" /> Correct
            </label>
            <button type="button" (click)="removeOption(q, j)" class="ml-2 text-red-500">Remove</button>
          </div>
          <button type="button" (click)="addOption(q)" class="text-blue-600 hover:underline text-sm">Add Option</button>
        </div>
      </div>
      <button type="button" (click)="addQuestion()" class="mt-2 bg-gray-200 hover:bg-gray-300 text-gray-800 px-3 py-1 rounded">Add Question</button>
    </div>
    <button type="submit" [disabled]="loading" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded">
      <span *ngIf="loading">Creating...</span>
      <span *ngIf="!loading">Create Exam</span>
    </button>
  </form>
  <div *ngIf="success" class="mt-4 text-green-600">{{ success }}</div>
  <div *ngIf="error" class="mt-4 text-red-600">{{ error }}</div>
</div>
